{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Model_Dao_Result API Contract",
  "description": "Schema for Model_Dao_Result and Model_Dao_Result<T> return types used by all DAO methods",
  "definitions": {
    "Model_Dao_Result": {
      "type": "object",
      "description": "Base result wrapper for non-data-returning operations (INSERT, UPDATE, DELETE)",
      "required": ["IsSuccess", "Message"],
      "properties": {
        "IsSuccess": {
          "type": "boolean",
          "description": "True if operation succeeded, false otherwise"
        },
        "Message": {
          "type": "string",
          "description": "Human-readable outcome description",
          "minLength": 1
        },
        "Exception": {
          "type": ["object", "null"],
          "description": "Exception object if operation failed, null otherwise",
          "properties": {
            "Type": {
              "type": "string",
              "description": "Exception type name (e.g., MySqlException, TimeoutException)"
            },
            "Message": {
              "type": "string",
              "description": "Exception message"
            },
            "StackTrace": {
              "type": ["string", "null"],
              "description": "Stack trace for debugging"
            }
          }
        }
      },
      "rules": [
        "If IsSuccess == false, Message MUST describe the failure reason",
        "If Exception is not null, IsSuccess MUST be false",
        "Message MUST be user-friendly (no technical jargon or stack traces)"
      ]
    },
    "Model_Dao_Result_Generic": {
      "type": "object",
      "description": "Generic result wrapper for data-returning operations (SELECT)",
      "required": ["IsSuccess", "Message", "Data"],
      "properties": {
        "IsSuccess": {
          "type": "boolean",
          "description": "True if operation succeeded, false otherwise"
        },
        "Message": {
          "type": "string",
          "description": "Human-readable outcome description",
          "minLength": 1
        },
        "Data": {
          "description": "Query result data, null if operation failed",
          "anyOf": [
            {"type": "object", "description": "DataTable for multi-row results"},
            {"type": "object", "description": "DataRow for single-row results"},
            {"type": "integer", "description": "Scalar results (counts, IDs)"},
            {"type": "boolean", "description": "Boolean results (exists checks)"},
            {"type": "null"}
          ]
        },
        "Exception": {
          "type": ["object", "null"],
          "description": "Exception object if operation failed, null otherwise"
        }
      },
      "rules": [
        "If IsSuccess == true, Data SHOULD NOT be null (except for zero-row queries)",
        "If IsSuccess == false, Data MUST be null",
        "Callers MUST check IsSuccess before accessing Data"
      ]
    }
  },
  "factories": {
    "Model_Dao_Result": {
      "Success": {
        "signature": "public static Model_Dao_Result Success(string message = \"Operation completed successfully\")",
        "returns": "Model_Dao_Result with IsSuccess=true, Message=message, Exception=null"
      },
      "Failure": {
        "signature": "public static Model_Dao_Result Failure(string message, Exception? exception = null)",
        "returns": "Model_Dao_Result with IsSuccess=false, Message=message, Exception=exception"
      }
    },
    "Model_Dao_Result_T": {
      "Success": {
        "signature": "public static Model_Dao_Result<T> Success(T data, string message = \"Operation completed successfully\")",
        "returns": "Model_Dao_Result<T> with IsSuccess=true, Data=data, Message=message, Exception=null"
      },
      "Failure": {
        "signature": "public static Model_Dao_Result<T> Failure(string message, Exception? exception = null)",
        "returns": "Model_Dao_Result<T> with IsSuccess=false, Data=default(T), Message=message, Exception=exception"
      }
    }
  },
  "usagePatterns": [
    {
      "scenario": "Non-query operation (INSERT/UPDATE/DELETE)",
      "returnType": "Model_Dao_Result",
      "example": {
        "success": {
          "IsSuccess": true,
          "Message": "Inventory item added successfully",
          "Exception": null
        },
        "failure": {
          "IsSuccess": false,
          "Message": "Failed to add inventory item: Part number already exists",
          "Exception": {
            "Type": "MySqlException",
            "Message": "Duplicate entry 'ABC123' for key 'PRIMARY'"
          }
        }
      }
    },
    {
      "scenario": "Query operation returning DataTable",
      "returnType": "Model_Dao_Result<DataTable>",
      "example": {
        "success": {
          "IsSuccess": true,
          "Message": "Retrieved 15 inventory items",
          "Data": {
            "type": "DataTable",
            "rows": 15,
            "columns": ["PartNumber", "LocationCode", "Quantity", "LastUpdated"]
          },
          "Exception": null
        },
        "failure": {
          "IsSuccess": false,
          "Message": "Failed to retrieve inventory: Connection timeout",
          "Data": null,
          "Exception": {
            "Type": "TimeoutException",
            "Message": "Timeout expired. The timeout period elapsed prior to completion of the operation."
          }
        }
      }
    },
    {
      "scenario": "Scalar query returning count",
      "returnType": "Model_Dao_Result<int>",
      "example": {
        "success": {
          "IsSuccess": true,
          "Message": "Retrieved inventory count",
          "Data": 42,
          "Exception": null
        }
      }
    },
    {
      "scenario": "Exists check",
      "returnType": "Model_Dao_Result<bool>",
      "example": {
        "success": {
          "IsSuccess": true,
          "Message": "Part exists check completed",
          "Data": true,
          "Exception": null
        }
      }
    }
  ],
  "callerContract": {
    "required": [
      "Always check IsSuccess before accessing Data property",
      "Always display Message to user (success or failure)",
      "Never access Data when IsSuccess == false",
      "Log Exception details when present (for troubleshooting)"
    ],
    "pattern": "if (result.IsSuccess) { /* use result.Data */ } else { /* show result.Message, log result.Exception */ }"
  }
}
